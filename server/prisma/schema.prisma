// Configuración básica
generator cliente {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

// --- Modelos de Datos ---

model Usuario {
  id               String    @id @default(uuid())
  correo           String    @unique
  clave            String
  nombre           String?
  patrones         Patron[]  // Relación: Un usuario puede tener muchos patrones
  fechaCreacion    DateTime  @default(now())
}

model Patron {
  id               String   @id @default(uuid())
  id_local         String   @unique // ID generado en el celular para evitar duplicados
  nombre           String
  categoria        String   // Ej: "Damas", "Caballeros"
  
  // Guardamos las medidas como un objeto JSON 
  medidas          Json     

  // Relación con el usuario
  usuario          Usuario  @relation(fields: [usuarioId], references: [id])
  usuarioId        String

  // Control de fechas
  fechaCreacion    DateTime @default(now())
  fechaActualizacion DateTime @updatedAt
  
  // Para saber cuándo se sincronizó con la nube
  fechaSincronizacion DateTime? 

  @@unique([usuarioId, id_local])
}